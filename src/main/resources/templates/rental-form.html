<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
    <head>
        <title>Renting Form</title>
        <link rel="stylesheet" th:href="@{/css/styles.css}" />
        <link rel="preconnect" href="https://fonts.googleapis.com" />
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
        <link
            href="https://fonts.googleapis.com/css2?family=Inter:ital,opsz,wght@0,14..32,100..900;1,14..32,100..900&display=swap"
            rel="stylesheet" />
    </head>
    <body>
        <div class="rental-container">
            <div class="rental-card">

                <!-- Game Info Section -->
                <div class="game-info" th:if="${selectedGame}">
                    <h1 th:text="${selectedGame.title}">Game Title</h1>
                </div>

                <form class="rentalForm" action="/rentals/create" method="post">
                    <div class="game-header inputDiv">
                        <label for="platform">Price per day</label>

                        <p class="price-info"
                            th:text="'RM' + ${selectedGame.pricePerDay}">
                        </p>
                    </div>
                    <!-- Hidden Fields -->
                    <input type="hidden" name="gameId"
                        th:value="${selectedGame.id}">
                    <input type="hidden" name="userId" th:value="${userId}">

                    <!-- Platform Field (Read-only) -->
                    <div class="inputDiv">
                        <label for="platform">Platform</label>
                        <p id="platform" th:text="${selectedGame.platform}"></p>
                    </div>

                    <!-- Duration Selection -->
                    <div class="inputDiv">
                        <label for="duration">Duration</label>
                        <select name="duration" id="duration" required>
                            <option value="7">1 week</option>
                            <option value="14">2 weeks</option>
                            <option value="30">1 month</option>
                            <option value="60">2 months</option>
                        </select>
                    </div>

                    <!-- Calculate dates based on duration -->
                    <input type="hidden" name="startDate" id="startDate">
                    <input type="hidden" name="endDate" id="endDate">
                    <div class="buttonDiv">
                        <button type="submit" class="rent-button">Rent
                            Game</button>
                    </div>
                </form>
            </div>
        </div>

        <script
            src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
        <script>
    document.addEventListener('DOMContentLoaded', function() {
        // Function to update hidden date fields based on duration
        function updateDates() {
            const duration = parseInt(document.getElementById('duration').value);
            const startDate = new Date();
            const endDate = new Date();
            endDate.setDate(startDate.getDate() + duration);

            document.getElementById('startDate').value = startDate.toISOString().split('T')[0];
            document.getElementById('endDate').value = endDate.toISOString().split('T')[0];
        }

        // Update dates when duration changes
        document.getElementById('duration').addEventListener('change', updateDates);

        // Set initial dates
        updateDates();
    });
</script>
    </body>
</html>